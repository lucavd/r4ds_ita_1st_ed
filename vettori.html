<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>20 Vettori | R for Data Science - edizione italiana</title>
<meta name="author" content="Hadley Wickham e Garrett Grolemund">
<meta name="description" content="20.1 Introduzione Finora questo libro si è concentrato sulle tibble e sui pacchetti che lavorano con esse. Ma quando inizierete a scrivere le vostre funzioni e a scavare più a fondo in R, avrete...">
<meta name="generator" content="bookdown 0.27.1 with bs4_book()">
<meta property="og:title" content="20 Vettori | R for Data Science - edizione italiana">
<meta property="og:type" content="book">
<meta property="og:url" content="http://it.r4ds.hadley.nz/vettori.html">
<meta property="og:image" content="http://it.r4ds.hadley.nz/cover.png">
<meta property="og:description" content="20.1 Introduzione Finora questo libro si è concentrato sulle tibble e sui pacchetti che lavorano con esse. Ma quando inizierete a scrivere le vostre funzioni e a scavare più a fondo in R, avrete...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="20 Vettori | R for Data Science - edizione italiana">
<meta name="twitter:site" content="@lucavd">
<meta name="twitter:description" content="20.1 Introduzione Finora questo libro si è concentrato sulle tibble e sui pacchetti che lavorano con esse. Ma quando inizierete a scrivere le vostre funzioni e a scavare più a fondo in R, avrete...">
<meta name="twitter:image" content="http://it.r4ds.hadley.nz/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1.9000/transition.js"></script><script src="libs/bs3compat-0.3.1.9000/tabs.js"></script><script src="libs/bs3compat-0.3.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet">
<script src="libs/str_view-binding-1.4.0/str_view.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-115082821-1');
  </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R for Data Science - edizione italiana</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Benvenuto</a></li>
<li><a class="" href="introduzione.html"><span class="header-section-number">1</span> Introduzione</a></li>
<li class="book-part">Esplora</li>
<li><a class="" href="explore-intro.html"><span class="header-section-number">2</span> Introduzione</a></li>
<li><a class="" href="visualizzazione.html"><span class="header-section-number">3</span> Visualizzazione</a></li>
<li><a class="" href="workflow-basi.html"><span class="header-section-number">4</span> Workflow: basi</a></li>
<li><a class="" href="transform.html"><span class="header-section-number">5</span> Trasformazione</a></li>
<li><a class="" href="workflow-script.html"><span class="header-section-number">6</span> Workflow: script</a></li>
<li><a class="" href="analisi-esplorativa.html"><span class="header-section-number">7</span> Analisi esplorativa</a></li>
<li><a class="" href="workflow-progetti.html"><span class="header-section-number">8</span> Workflow: progetti</a></li>
<li class="book-part">Wrangle</li>
<li><a class="" href="wrangle-intro.html"><span class="header-section-number">9</span> Introduzione</a></li>
<li><a class="" href="tibble.html"><span class="header-section-number">10</span> Tibble</a></li>
<li><a class="" href="importazione-dei-dati.html"><span class="header-section-number">11</span> Importazione dei dati</a></li>
<li><a class="" href="tidy-data.html"><span class="header-section-number">12</span> Tidy data</a></li>
<li><a class="" href="dati-relazionali.html"><span class="header-section-number">13</span> Dati relazionali</a></li>
<li><a class="" href="stringhe.html"><span class="header-section-number">14</span> Stringhe</a></li>
<li><a class="" href="fattori.html"><span class="header-section-number">15</span> Fattori</a></li>
<li><a class="" href="date-e-tempi.html"><span class="header-section-number">16</span> Date e tempi</a></li>
<li class="book-part">Programmare</li>
<li><a class="" href="program-intro.html"><span class="header-section-number">17</span> Introduzione</a></li>
<li><a class="" href="pipe.html"><span class="header-section-number">18</span> Pipe</a></li>
<li><a class="" href="funzioni.html"><span class="header-section-number">19</span> Funzioni</a></li>
<li><a class="active" href="vettori.html"><span class="header-section-number">20</span> Vettori</a></li>
<li><a class="" href="iterazioni.html"><span class="header-section-number">21</span> Iterazioni</a></li>
<li class="book-part">Model</li>
<li><a class="" href="model-intro.html"><span class="header-section-number">22</span> Introduzione</a></li>
<li><a class="" href="modelli-base.html"><span class="header-section-number">23</span> Modelli base</a></li>
<li><a class="" href="costruire-modelli.html"><span class="header-section-number">24</span> Costruire modelli</a></li>
<li><a class="" href="molti-modelli.html"><span class="header-section-number">25</span> Molti modelli</a></li>
<li class="book-part">Comunicare</li>
<li><a class="" href="communicate-intro.html"><span class="header-section-number">26</span> Introduzione</a></li>
<li><a class="" href="r-markdown.html"><span class="header-section-number">27</span> R Markdown</a></li>
<li><a class="" href="grafici-per-la-comunicazione.html"><span class="header-section-number">28</span> Grafici per la comunicazione</a></li>
<li><a class="" href="formati-di-r-markdown.html"><span class="header-section-number">29</span> Formati di R Markdown</a></li>
<li><a class="" href="r-markdown-workflow.html"><span class="header-section-number">30</span> R Markdown workflow</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/lucavd/r4ds_ita_1st_ed">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="vettori" class="section level1">
<h1>
<span class="header-section-number">20</span> Vettori<a class="anchor" aria-label="anchor" href="#vettori"><i class="fas fa-link"></i></a>
</h1>
<div id="introduzione-13" class="section level2">
<h2>
<span class="header-section-number">20.1</span> Introduzione<a class="anchor" aria-label="anchor" href="#introduzione-13"><i class="fas fa-link"></i></a>
</h2>
<p>Finora questo libro si è concentrato sulle tibble e sui pacchetti che lavorano con esse. Ma quando inizierete a scrivere le vostre funzioni e a scavare più a fondo in R, avrete bisogno di imparare i vettori, gli oggetti che sono alla base delle tibble. Se avete imparato R in modo più tradizionale, probabilmente avete già familiarità con i vettori, dato che la maggior parte delle risorse di R inizia con i vettori e si fa strada fino alle tibble. Penso che sia meglio iniziare con le tibble perché sono immediatamente utili, e poi lavorare fino ai componenti sottostanti.</p>
<p>I vettori sono particolarmente importanti perché la maggior parte delle funzioni che scriverete lavoreranno con i vettori. È possibile scrivere funzioni che lavorano con le tibbie (come ggplot2, dplyr e tidyr), ma gli strumenti necessari per scrivere tali funzioni sono attualmente idiosincratici e immaturi. Sto lavorando ad un approccio migliore, <a href="https://github.com/hadley/lazyeval" class="uri">https://github.com/hadley/lazyeval</a>, ma non sarà pronto in tempo per la pubblicazione del libro. Anche quando sarà completo, avrete ancora bisogno di capire i vettori, renderà solo più facile scrivere un livello user-friendly sopra.</p>
<div id="prerequisiti-13" class="section level3">
<h3>
<span class="header-section-number">20.1.1</span> Prerequisiti<a class="anchor" aria-label="anchor" href="#prerequisiti-13"><i class="fas fa-link"></i></a>
</h3>
<p>Il focus di questo capitolo è sulle strutture dati di base di R, quindi non è essenziale caricare alcun pacchetto. Tuttavia, useremo una manciata di funzioni del pacchetto <strong>purrr</strong> per evitare alcune incongruenze in R base.</p>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="nozioni-di-base-sui-vettori" class="section level2">
<h2>
<span class="header-section-number">20.2</span> Nozioni di base sui vettori<a class="anchor" aria-label="anchor" href="#nozioni-di-base-sui-vettori"><i class="fas fa-link"></i></a>
</h2>
<p>Ci sono due tipi di vettori:</p>
<ol style="list-style-type: decimal">
<li><ol style="list-style-type: decimal">
<li>Vettori <strong>atomic</strong>, di cui esistono sei tipi:
<strong>logical</strong>, <strong>integer</strong>, <strong>double</strong>, <strong>character</strong>, <strong>complex</strong>, e
<strong>raw</strong>. I vettori interi e doppi sono conosciuti collettivamente come
vettori <strong>numerici</strong>.</li>
</ol></li>
<li>
<strong>Liste</strong>, che a volte sono chiamate vettori ricorsivi perché le liste possono contenere altre liste.</li>
</ol>
<p>La differenza principale tra vettori atomici e liste è che i vettori atomici sono <strong>omogenei</strong>, mentre le liste possono essere <strong>eterogenee</strong>. C’è un altro oggetto correlato: <code>NULL</code>. <code>NULL</code> è spesso usato per rappresentare l’assenza di un vettore (al contrario di <code>NA</code> che è usato per rappresentare l’assenza di un valore in un vettore). <code>NULL</code> si comporta tipicamente come un vettore di lunghezza 0. La figura <a href="vettori.html#fig:datatypes">20.1</a> riassume le interrelazioni.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:datatypes"></span>
<img src="diagrams/data-structures-overview.png" alt="The hierarchy of R's vector types" width="50%"><p class="caption">
Figure 20.1: The hierarchy of R’s vector types
</p>
</div>
<p>Ogni vettore ha due proprietà chiave:</p>
<ol style="list-style-type: decimal">
<li>
<p>Il suo <strong>tipo</strong>, che potete determinare con <code><a href="https://rdrr.io/r/base/typeof.html">typeof()</a></code>.</p>
<div class="sourceCode" id="cb494"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">letters</span><span class="op">)</span>
<span class="co">#&gt; [1] "character"</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; [1] "integer"</span></code></pre></div>
</li>
<li>
<p>La sua <strong>length</strong>, che potete determinare con <code><a href="https://rdrr.io/r/base/length.html">length()</a></code>.</p>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] 3</span></code></pre></div>
</li>
</ol>
<p>I vettori possono anche contenere metadati aggiuntivi arbitrari sotto forma di attributi. Questi attributi sono usati per creare <strong>vettori aumentati</strong> che si basano su comportamenti aggiuntivi. Ci sono tre tipi importanti di vettori aumentati:</p>
<ul>
<li>I fattori sono costruiti sopra i vettori interi.</li>
<li>Date e date-ora sono costruiti sopra vettori numerici.</li>
<li>I data frame e le tibble sono costruiti sopra le liste.</li>
</ul>
<p>Questo capitolo vi introdurrà a questi importanti vettori dal più semplice al più complicato. Inizierete con i vettori atomici, poi arriverete alle liste, e finirete con i vettori aumentati.</p>
</div>
<div id="tipi-importanti-di-vettori-atomici" class="section level2">
<h2>
<span class="header-section-number">20.3</span> Tipi importanti di vettori atomici<a class="anchor" aria-label="anchor" href="#tipi-importanti-di-vettori-atomici"><i class="fas fa-link"></i></a>
</h2>
<p>I quattro tipi più importanti di vettore atomico sono logico, intero, doppio e carattere. Raw e complex sono usati raramente durante un’analisi dei dati, quindi non li discuterò qui.</p>
<div id="logico" class="section level3">
<h3>
<span class="header-section-number">20.3.1</span> Logico<a class="anchor" aria-label="anchor" href="#logico"><i class="fas fa-link"></i></a>
</h3>
<p>I vettori logici sono il tipo più semplice di vettore atomico perché possono assumere solo tre possibili valori: <code>FALSE</code>, <code>TRUE</code> e <code>NA</code>. I vettori logici sono solitamente costruiti con operatori di confronto, come descritto in [comparatori]. Puoi anche crearli a mano con <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>:</p>
<div class="sourceCode" id="cb496"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">3</span> <span class="op">==</span> <span class="fl">0</span>
<span class="co">#&gt;  [1] FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE</span>

<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="co">#&gt; [1]  TRUE  TRUE FALSE    NA</span></code></pre></div>
</div>
<div id="numerico" class="section level3">
<h3>
<span class="header-section-number">20.3.2</span> Numerico<a class="anchor" aria-label="anchor" href="#numerico"><i class="fas fa-link"></i></a>
</h3>
<p>I vettori interi e doppi sono conosciuti collettivamente come vettori numerici. In R, i numeri sono doppi per default. Per fare un intero, metti una <code>L</code> dopo il numero:</p>
<div class="sourceCode" id="cb497"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; [1] "double"</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span>
<span class="co">#&gt; [1] "integer"</span>
<span class="fl">1.5L</span>
<span class="co">#&gt; [1] 1.5</span></code></pre></div>
<p>La distinzione tra interi e double non è solitamente importante, ma ci sono due importanti differenze di cui dovreste essere consapevoli:</p>
<ol style="list-style-type: decimal">
<li>
<p>I double sono approssimazioni. I double rappresentano numeri in virgola mobile che non possono essere sempre rappresentati con precisione con una quantità fissa di memoria. Questo significa che dovreste considerare tutti i double come approssimazioni. Per esempio, cos’è il quadrato della radice quadrata di due?</p>
<div class="sourceCode" id="cb498"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>
<span class="va">x</span>
<span class="co">#&gt; [1] 2</span>
<span class="va">x</span> <span class="op">-</span> <span class="fl">2</span>
<span class="co">#&gt; [1] 4.440892e-16</span></code></pre></div>
<p>Questo comportamento è comune quando si lavora con i numeri in virgola mobile: la maggior parte
calcoli includono qualche errore di approssimazione. Invece di confrontare i numeri in virgola mobile
in virgola mobile usando <code>==</code>, dovreste usare <code><a href="https://dplyr.tidyverse.org/reference/near.html">dplyr::near()</a></code> che permette
qualche tolleranza numerica.</p>
</li>
<li>
<p>Gli interi hanno un valore speciale: <code>NA</code>, mentre i double ne hanno quattro:
<code>NA</code>, <code>NaN</code>, <code>Inf</code> e <code>-Inf</code>. Tutti e tre i valori speciali <code>NaN</code>, <code>Inf</code> e <code>-Inf</code> possono presentarsi durante la divisione:</p>
<div class="sourceCode" id="cb499"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">0</span>
<span class="co">#&gt; [1] -Inf  NaN  Inf</span></code></pre></div>
<p>Evita di usare <code>==</code> per controllare questi altri valori speciali. Usate invece le
funzioni di aiuto <code><a href="https://rdrr.io/r/base/is.finite.html">is.finite()</a></code>, <code><a href="https://rdrr.io/r/base/is.finite.html">is.infinite()</a></code>, e <code><a href="https://rdrr.io/r/base/is.finite.html">is.nan()</a></code>:</p>
<table class="table table-sm">
<thead><tr class="header">
<th></th>
<th>0</th>
<th>Inf</th>
<th>NA</th>
<th>NaN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/is.finite.html">is.finite()</a></code></td>
<td>x</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/base/is.finite.html">is.infinite()</a></code></td>
<td></td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/base/NA.html">is.na()</a></code></td>
<td></td>
<td></td>
<td>x</td>
<td>x</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/base/is.finite.html">is.nan()</a></code></td>
<td></td>
<td></td>
<td></td>
<td>x</td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
<div id="carattere" class="section level3">
<h3>
<span class="header-section-number">20.3.3</span> Carattere<a class="anchor" aria-label="anchor" href="#carattere"><i class="fas fa-link"></i></a>
</h3>
<p>I vettori di caratteri sono il tipo più complesso di vettore atomico, perché ogni elemento di un vettore di caratteri è una stringa, e una stringa può contenere una quantità arbitraria di dati.</p>
<p>Hai già imparato molto su come lavorare con le stringhe in <a href="stringhe.html#stringhe">stringhe</a>. Qui volevo menzionare una caratteristica importante dell’implementazione delle stringhe sottostanti: R usa un pool globale di stringhe. Questo significa che ogni stringa unica è immagazzinata in memoria solo una volta, e ogni uso della stringa punta a quella rappresentazione. Questo riduce la quantità di memoria necessaria alle stringhe duplicate. Potete vedere questo comportamento in pratica con <code><a href="https://rdrr.io/pkg/pryr/man/object_size.html">pryr::object_size()</a></code>:</p>
<div class="sourceCode" id="cb500"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"This is a reasonably long string."</span>
<span class="fu">pryr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pryr/man/object_size.html">object_size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; 152 B</span>

<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="fu">pryr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pryr/man/object_size.html">object_size</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; 8,144 B</span></code></pre></div>
<p><code>y</code> non occupa 1000 volte più memoria di <code>x</code>, perché ogni elemento di <code>y</code> è solo un puntatore a quella stessa stringa. Un puntatore è di 8 byte, quindi 1000 puntatori a una stringa di 152 B sono 8 * 1000 + 152 = 8.14 kB.</p>
</div>
<div id="valori-mancanti-4" class="section level3">
<h3>
<span class="header-section-number">20.3.4</span> Valori mancanti<a class="anchor" aria-label="anchor" href="#valori-mancanti-4"><i class="fas fa-link"></i></a>
</h3>
<p>Nota che ogni tipo di vettore atomico ha il suo valore mancante:</p>
<div class="sourceCode" id="cb501"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="cn">NA</span>            <span class="co"># logical</span>
<span class="co">#&gt; [1] NA</span>
<span class="cn">NA_integer_</span>   <span class="co"># integer</span>
<span class="co">#&gt; [1] NA</span>
<span class="cn">NA_real_</span>      <span class="co"># double</span>
<span class="co">#&gt; [1] NA</span>
<span class="cn">NA_character_</span> <span class="co"># character</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>Normalmente non avete bisogno di conoscere questi diversi tipi perché potete sempre usare <code>NA</code> e sarà convertito nel tipo corretto usando le regole di coercizione implicite descritte in seguito. Tuttavia, ci sono alcune funzioni che sono rigide riguardo ai loro input, quindi è utile avere questa conoscenza in tasca in modo da poter essere specifici quando necessario.</p>
</div>
<div id="esercizi-54" class="section level3">
<h3>
<span class="header-section-number">20.3.5</span> Esercizi<a class="anchor" aria-label="anchor" href="#esercizi-54"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Descrivete la differenza tra <code>is.finite(x)</code> e <code>!is.infinite(x)</code>.</p></li>
<li><p>Leggete il codice sorgente di <code><a href="https://dplyr.tidyverse.org/reference/near.html">dplyr::near()</a></code> (Suggerimento: per vedere il codice sorgente,
eliminate il <code>()</code>). Come funziona?</p></li>
<li><p>Un vettore logico può assumere 3 possibili valori. Quanti valori possibili
valori possibili può assumere un vettore intero? Quanti valori possibili può assumere
prendere un double? Usa Google per fare qualche ricerca.</p></li>
<li><p>Inventa almeno quattro funzioni che ti permettono di convertire un doppio in un
intero. In cosa differiscono? Sii preciso.</p></li>
<li><p>Quali funzioni del pacchetto readr ti permettono di trasformare una stringa
in un vettore logico, intero e double?</p></li>
</ol>
</div>
</div>
<div id="usare-i-vettori-atomici" class="section level2">
<h2>
<span class="header-section-number">20.4</span> Usare i vettori atomici<a class="anchor" aria-label="anchor" href="#usare-i-vettori-atomici"><i class="fas fa-link"></i></a>
</h2>
<p>Ora che hai capito i diversi tipi di vettore atomico, è utile rivedere alcuni degli strumenti importanti per lavorare con essi. Questi includono:</p>
<ol style="list-style-type: decimal">
<li><p>Come convertire da un tipo all’altro e quando ciò avviene
automaticamente.</p></li>
<li><p>Come capire se un oggetto è un tipo specifico di vettore.</p></li>
<li><p>Cosa succede quando si lavora con vettori di diversa lunghezza.</p></li>
<li><p>Come nominare gli elementi di un vettore.</p></li>
<li><p>Come estrarre gli elementi di interesse.</p></li>
</ol>
<div id="coercizione" class="section level3">
<h3>
<span class="header-section-number">20.4.1</span> Coercizione<a class="anchor" aria-label="anchor" href="#coercizione"><i class="fas fa-link"></i></a>
</h3>
<p>Ci sono due modi per convertire, o coercere, un tipo di vettore in un altro:</p>
<ol style="list-style-type: decimal">
<li><p>La coercizione esplicita avviene quando si chiama una funzione come <code><a href="https://rdrr.io/r/base/logical.html">as.logical()</a></code>,
<code><a href="https://rdrr.io/r/base/integer.html">as.integer()</a></code>, <code><a href="https://rdrr.io/r/base/double.html">as.double()</a></code>, o <code><a href="https://rdrr.io/r/base/character.html">as.character()</a></code>. Ogni volta che vi trovate
te di usare la coercizione esplicita, dovresti sempre controllare se è possibile
fare la correzione a monte, in modo che il vettore non abbia mai avuto il tipo sbagliato in
all’inizio. Per esempio, potrebbe essere necessario modificare la specifica di readr
<code>col_types</code>.</p></li>
<li><p>La coercizione implicita avviene quando si usa un vettore in un contesto specifico
che si aspetta un certo tipo di vettore. Per esempio, quando usate un vettore logico
logico con una funzione di riepilogo numerico, o quando si usa un vettore doppio
dove ci si aspetta un vettore intero.</p></li>
</ol>
<p>Poiché la coercizione esplicita è usata relativamente raramente, ed è in gran parte facile da capire, mi concentrerò sulla coercizione implicita qui.</p>
<p>Avete già visto il tipo più importante di coercizione implicita: usare un vettore logico in un contesto numerico. In questo caso <code>TRUE</code> è convertito in <code>1</code> e <code>FALSE</code> convertito in <code>0</code>. Ciò significa che la somma di un vettore logico è il numero di veri, e la media di un vettore logico è la proporzione di veri:</p>
<div class="sourceCode" id="cb502"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">10</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>  <span class="co"># quanti sono maggiori di 10?</span>
<span class="co">#&gt; [1] 38</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="co"># quale proporzione è maggiore di 10?</span>
<span class="co">#&gt; [1] 0.38</span></code></pre></div>
<p>Potreste vedere del codice (tipicamente più vecchio) che si basa sulla coercizione implicita nella direzione opposta, da intero a logico:</p>
<div class="sourceCode" id="cb503"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># fa qualcosa</span>
<span class="op">}</span></code></pre></div>
<p>In questo caso, 0 è convertito in <code>FALSE</code> e tutto il resto è convertito in <code>TRUE</code>. Penso che questo renda più difficile capire il tuo codice, e non lo consiglio. Sii invece esplicito: <code>lunghezza(x) &gt; 0</code>.</p>
<p>È anche importante capire cosa succede quando provate a creare un vettore contenente più tipi con <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>: il tipo più complesso vince sempre.</p>
<div class="sourceCode" id="cb504"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "integer"</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "double"</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "character"</span></code></pre></div>
<p>Un vettore atomico non può avere un mix di tipi diversi perché il tipo è una proprietà del vettore completo, non dei singoli elementi. Se hai bisogno di mescolare più tipi nello stesso vettore, dovresti usare una lista, che imparerai a conoscere tra poco.</p>
</div>
<div id="funzioni-di-test" class="section level3">
<h3>
<span class="header-section-number">20.4.2</span> Funzioni di test<a class="anchor" aria-label="anchor" href="#funzioni-di-test"><i class="fas fa-link"></i></a>
</h3>
<p>A volte vuoi fare cose diverse in base al tipo di vettore. Un’opzione è usare <code><a href="https://rdrr.io/r/base/typeof.html">typeof()</a></code>. Un’altra è usare una funzione di test che restituisca un <code>TRUE</code> o un <code>FALSE</code>. Base R fornisce molte funzioni come <code><a href="https://rdrr.io/r/base/vector.html">is.vector()</a></code> e <code><a href="https://rdrr.io/r/base/is.recursive.html">is.atomic()</a></code>, ma spesso restituiscono risultati sorprendenti. Invece, è più sicuro usare le funzioni <code>is_*</code> fornite da purrr, che sono riassunte nella tabella qui sotto.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th></th>
<th>lgl</th>
<th>int</th>
<th>dbl</th>
<th>chr</th>
<th>list</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://rlang.r-lib.org/reference/type-predicates.html">is_logical()</a></code></td>
<td>x</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="https://rlang.r-lib.org/reference/type-predicates.html">is_integer()</a></code></td>
<td></td>
<td>x</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="https://rlang.r-lib.org/reference/type-predicates.html">is_double()</a></code></td>
<td></td>
<td></td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="https://purrr.tidyverse.org/reference/is_numeric.html">is_numeric()</a></code></td>
<td></td>
<td>x</td>
<td>x</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="https://rlang.r-lib.org/reference/type-predicates.html">is_character()</a></code></td>
<td></td>
<td></td>
<td></td>
<td>x</td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="https://rlang.r-lib.org/reference/type-predicates.html">is_atomic()</a></code></td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="https://rlang.r-lib.org/reference/type-predicates.html">is_list()</a></code></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>x</td>
</tr>
<tr class="even">
<td><code><a href="https://rlang.r-lib.org/reference/type-predicates.html">is_vector()</a></code></td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
<td>x</td>
</tr>
</tbody>
</table></div>
</div>
<div id="scalari-e-regole-di-riciclaggio" class="section level3">
<h3>
<span class="header-section-number">20.4.3</span> Scalari e regole di riciclaggio<a class="anchor" aria-label="anchor" href="#scalari-e-regole-di-riciclaggio"><i class="fas fa-link"></i></a>
</h3>
<p>Oltre a costringere implicitamente i tipi di vettori ad essere compatibili, R costringerà implicitamente anche la lunghezza dei vettori. Questo è chiamato riciclo dei vettori, perché il vettore più corto viene ripetuto, o riciclato, alla stessa lunghezza del vettore più lungo.</p>
<p>Questo è generalmente più utile quando si mescolano vettori e “scalari”. Ho messo gli scalari tra virgolette perché R in realtà non ha scalari: invece, un singolo numero è un vettore di lunghezza 1. Poiché non ci sono scalari, la maggior parte delle funzioni built-in sono <strong>vettorizzate</strong>, il che significa che opereranno su un vettore di numeri. Ecco perché, per esempio, questo codice funziona:</p>
<div class="sourceCode" id="cb505"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span>
<span class="co">#&gt;  [1] 107 104 103 109 102 101 106 110 105 108</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.5</span>
<span class="co">#&gt;  [1] FALSE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span></code></pre></div>
<p>In R, le operazioni matematiche di base lavorano con i vettori. Ciò significa che non dovreste mai aver bisogno di eseguire un’iterazione esplicita quando eseguite semplici calcoli matematici.</p>
<p>È intuitivo ciò che dovrebbe accadere se si aggiungono due vettori della stessa lunghezza, o un vettore e uno “scalare”, ma cosa succede se si aggiungono due vettori di lunghezza diversa?</p>
<div class="sourceCode" id="cb506"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>
<span class="co">#&gt;  [1]  2  4  4  6  6  8  8 10 10 12</span></code></pre></div>
<p>Qui, R espanderà il vettore più breve alla stessa lunghezza del più lungo, il cosiddetto riciclo. Questo è silenzioso tranne quando la lunghezza del più lungo non è un multiplo intero della lunghezza del più corto:</p>
<div class="sourceCode" id="cb507"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></code></pre></div>
<p>Mentre il riciclo vettoriale può essere usato per creare codice molto succinto e intelligente, può anche nascondere silenziosamente dei problemi. Per questo motivo, le funzioni vettoriali di tidyverse daranno errore quando si ricicla qualcosa che non sia uno scalare. Se volete riciclare, dovrete farlo voi stessi con <code><a href="https://rdrr.io/r/base/rep.html">rep()</a></code>:</p>
<div class="sourceCode" id="cb508"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Error:</span>
<span class="co">#&gt; ! Tibble columns must have compatible sizes.</span>
<span class="co">#&gt; • Size 4: Existing data.</span>
<span class="co">#&gt; • Size 2: Column `y`.</span>
<span class="co">#&gt; ℹ Only values of size one are recycled.</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 × 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1     1     1</span>
<span class="co">#&gt; 2     2     2</span>
<span class="co">#&gt; 3     3     1</span>
<span class="co">#&gt; 4     4     2</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 × 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1     1     1</span>
<span class="co">#&gt; 2     2     1</span>
<span class="co">#&gt; 3     3     2</span>
<span class="co">#&gt; 4     4     2</span></code></pre></div>
</div>
<div id="denominazione-dei-vettori" class="section level3">
<h3>
<span class="header-section-number">20.4.4</span> Denominazione dei vettori<a class="anchor" aria-label="anchor" href="#denominazione-dei-vettori"><i class="fas fa-link"></i></a>
</h3>
<p>Tutti i tipi di vettori possono essere nominati. Puoi nominarli durante la creazione con <code><a href="https://rdrr.io/r/base/c.html">c()</a></code>:</p>
<div class="sourceCode" id="cb509"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span>, z <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; x y z </span>
<span class="co">#&gt; 1 2 4</span></code></pre></div>
<p>O dopo averlo fatto, con <code><a href="https://purrr.tidyverse.org/reference/set_names.html">purrr::set_names()</a></code>:</p>
<div class="sourceCode" id="cb510"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://purrr.tidyverse.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; a b c </span>
<span class="co">#&gt; 1 2 3</span></code></pre></div>
<p>I vettori nominati sono molto utili per il subsetting, descritto di seguito.</p>
</div>
<div id="vector-subsetting" class="section level3">
<h3>
<span class="header-section-number">20.4.5</span> Sottoinsiemi<a class="anchor" aria-label="anchor" href="#vector-subsetting"><i class="fas fa-link"></i></a>
</h3>
<p>Finora abbiamo usato <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code> per filtrare le righe in una tibla. Il <code>filtro()</code> funziona solo con le tibbie, quindi avremo bisogno di un nuovo strumento per i vettori: <code>[</code>. <code>[</code> è la funzione di sottoinsieme, e si chiama come <code>x[a]</code>. Ci sono quattro tipi di cose con cui è possibile subsettare un vettore:</p>
<ol style="list-style-type: decimal">
<li>
<p>Un vettore numerico contenente solo numeri interi. I numeri interi devono essere o tutti
positivi, tutti negativi o zero.</p>
<p>Il sottoinsieme con i numeri interi positivi mantiene gli elementi in quelle posizioni:</p>
<div class="sourceCode" id="cb511"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="st">"four"</span>, <span class="st">"five"</span><span class="op">)</span>
<span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1] "three" "two"   "five"</span></code></pre></div>
<p>Ripetendo una posizione, si può effettivamente fare un output più lungo dell’input:</p>
<div class="sourceCode" id="cb512"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1] "one"  "one"  "five" "five" "five" "two"</span></code></pre></div>
<p>I valori negativi fanno cadere gli elementi nelle posizioni specificate:</p>
<div class="sourceCode" id="cb513"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1] "two"  "four"</span></code></pre></div>
<p>È un errore mischiare valori positivi e negativi:</p>
<div class="sourceCode" id="cb514"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; Error in x[c(1, -1)]: only 0's may be mixed with negative subscripts</span></code></pre></div>
<p>Il messaggio di errore menziona il subsetting con zero, che non restituisce alcun valore:</p>
<div class="sourceCode" id="cb515"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span>
<span class="co">#&gt; character(0)</span></code></pre></div>
<p>Questo non è utile molto spesso, ma può essere utile se volete creare
strutture di dati insolite con cui testare le vostre funzioni.</p>
</li>
<li>
<p>Il sottoinsieme con un vettore logico mantiene tutti i valori corrispondenti ad un
valore <code>TRUE</code>. Questo è più spesso utile in combinazione con le
funzioni di confronto.</p>
<div class="sourceCode" id="cb516"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span>, <span class="cn">NA</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>

<span class="co"># Tutti i valori non mancanti di x</span>
<span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; [1] 10  3  5  8  1</span>

<span class="co"># Tutti i valori pari (o mancanti!) di x</span>
<span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>
<span class="co">#&gt; [1] 10 NA  8 NA</span></code></pre></div>
</li>
<li>
<p>Se avete un vettore di nome, potete sottoinvestirlo con un vettore di caratteri:</p>
<div class="sourceCode" id="cb517"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>abc <span class="op">=</span> <span class="fl">1</span>, def <span class="op">=</span> <span class="fl">2</span>, xyz <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"xyz"</span>, <span class="st">"def"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; xyz def </span>
<span class="co">#&gt;   5   2</span></code></pre></div>
<p>Come con gli interi positivi, potete anche usare un vettore di caratteri per
duplicare singole voci.</p>
</li>
<li><p>Il tipo più semplice di sottoinsieme è il nulla, <code>x[]</code>, che restituisce il
completo <code>x</code>. Questo non è utile per il sottoinsieme di vettori, ma è utile
quando si sottopongono matrici (e altre strutture ad alta dimensione) perché
permette di selezionare tutte le righe o tutte le colonne, lasciando
indice vuoto. Per esempio, se <code>x</code> è 2d, <code>x[1, ]</code> seleziona la prima riga e
tutte le colonne, e <code>x[, -1]</code> seleziona tutte le righe e tutte le colonne tranne
la prima.</p></li>
</ol>
<p>Per saperne di più sulle applicazioni del subsetting, leggete il capitolo “Subsetting” di <em>Advanced R</em>: <a href="http://adv-r.had.co.nz/Subsetting.html#applications" class="uri">http://adv-r.had.co.nz/Subsetting.html#applications</a>.</p>
<p>C’è un’importante variazione di <code>[</code> chiamata <code>[[</code>. <code>[[</code> estrae sempre e solo un singolo elemento, e abbandona sempre i nomi. È una buona idea usarla ogni volta che volete rendere chiaro che state estraendo un singolo elemento, come in un ciclo for. La distinzione tra <code>[</code> e <code>[[</code> è più importante per le liste, come vedremo tra poco.</p>
</div>
<div id="esercizi-55" class="section level3">
<h3>
<span class="header-section-number">20.4.6</span> Esercizi<a class="anchor" aria-label="anchor" href="#esercizi-55"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Cosa ti dice il <code>mean(is.na(x))</code> di un vettore <code>x</code>? 2. Che dire di
<code>sum(!is.finite(x))</code>?</p></li>
<li><p>Leggete attentamente la documentazione di <code><a href="https://rdrr.io/r/base/vector.html">is.vector()</a></code>. Cosa verifica effettivamente
verifica? Perché <code><a href="https://rdrr.io/r/base/is.recursive.html">is.atomic()</a></code> non concorda con la definizione di
vettori atomici di cui sopra?</p></li>
<li><p>Confronta e contrasta <code><a href="https://rdrr.io/r/stats/setNames.html">setNames()</a></code> con <code><a href="https://purrr.tidyverse.org/reference/set_names.html">purrr::set_names()</a></code>.</p></li>
<li>
<p>Creare funzioni che prendono un vettore come input e restituiscono:</p>
<ol style="list-style-type: decimal">
<li><p>L’ultimo valore. Dovreste usare <code>[</code> o <code>[[</code>?</p></li>
<li><p>Gli elementi nelle posizioni pari.</p></li>
<li><p>Ogni elemento tranne l’ultimo valore.</p></li>
<li><p>Solo i numeri pari (e nessun valore mancante).</p></li>
</ol>
</li>
<li><p>Perché <code>x[-che(x &gt; 0)]</code>non è lo stesso di <code>x[x &lt;= 0]</code>?</p></li>
<li><p>Cosa succede quando si sottoinveste con un numero intero positivo più grande
della lunghezza del vettore? Cosa succede quando si effettua un sottoinsieme con un
nome che non esiste?</p></li>
</ol>
</div>
</div>
<div id="liste" class="section level2">
<h2>
<span class="header-section-number">20.5</span> Vettori ricorsivi (liste)<a class="anchor" aria-label="anchor" href="#liste"><i class="fas fa-link"></i></a>
</h2>
<p>Le liste sono un passo avanti nella complessità rispetto ai vettori atomici, perché le liste possono contenere altre liste. Questo le rende adatte a rappresentare strutture gerarchiche o ad albero. Si crea una lista con <code><a href="https://rdrr.io/r/base/list.html">list()</a></code>:</p>
<div class="sourceCode" id="cb518"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">x</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p>Uno strumento molto utile per lavorare con le liste è <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> perché si concentra sulla <strong>struttura</strong>, non sul contenuto.</p>
<div class="sourceCode" id="cb519"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ : num 1</span>
<span class="co">#&gt;  $ : num 2</span>
<span class="co">#&gt;  $ : num 3</span>

<span class="va">x_named</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">2</span>, c <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">x_named</span><span class="op">)</span>
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ a: num 1</span>
<span class="co">#&gt;  $ b: num 2</span>
<span class="co">#&gt;  $ c: num 3</span></code></pre></div>
<p>A differenza dei vettori atomici, <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> può contenere un mix di oggetti:</p>
<div class="sourceCode" id="cb520"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fl">1L</span>, <span class="fl">1.5</span>, <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ : chr "a"</span>
<span class="co">#&gt;  $ : int 1</span>
<span class="co">#&gt;  $ : num 1.5</span>
<span class="co">#&gt;  $ : logi TRUE</span></code></pre></div>
<p>Le liste possono anche contenere altre liste!</p>
<div class="sourceCode" id="cb521"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ :List of 2</span>
<span class="co">#&gt;   ..$ : num 1</span>
<span class="co">#&gt;   ..$ : num 2</span>
<span class="co">#&gt;  $ :List of 2</span>
<span class="co">#&gt;   ..$ : num 3</span>
<span class="co">#&gt;   ..$ : num 4</span></code></pre></div>
<div id="visualizzazione-delle-liste" class="section level3">
<h3>
<span class="header-section-number">20.5.1</span> Visualizzazione delle liste<a class="anchor" aria-label="anchor" href="#visualizzazione-delle-liste"><i class="fas fa-link"></i></a>
</h3>
<p>Per spiegare le funzioni di manipolazione delle liste più complicate, è utile avere una rappresentazione visiva delle liste. Per esempio, prendete queste tre liste:</p>
<div class="sourceCode" id="cb522"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Li disegnerò come segue:</p>
<div class="inline-figure"><img src="diagrams/lists-structure.png" width="75%" style="display: block; margin: auto;"></div>
<p>Ci sono tre principi:</p>
<ol style="list-style-type: decimal">
<li><p>Le liste hanno angoli arrotondati. I vettori atomici hanno angoli quadrati.</p></li>
<li><p>I figli sono disegnati all’interno del loro genitore e hanno uno sfondo
sfondo per rendere più facile vedere la gerarchia.</p></li>
<li><p>L’orientamento dei figli (cioè righe o colonne) non è importante,
quindi sceglierò un orientamento di riga o di colonna per risparmiare spazio o per illustrare
una proprietà importante nell’esempio.</p></li>
</ol>
</div>
<div id="sottoinsieme" class="section level3">
<h3>
<span class="header-section-number">20.5.2</span> Sottoinsieme<a class="anchor" aria-label="anchor" href="#sottoinsieme"><i class="fas fa-link"></i></a>
</h3>
<p>Ci sono tre modi per suddividere una lista, che illustrerò con una lista chiamata <code>a</code>:</p>
<div class="sourceCode" id="cb523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, b <span class="op">=</span> <span class="st">"a string"</span>, c <span class="op">=</span> <span class="va">pi</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ul>
<li>
<p><code>[</code> estrae una sotto-lista. Il risultato sarà sempre una lista.</p>
<div class="sourceCode" id="cb524"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ a: int [1:3] 1 2 3</span>
<span class="co">#&gt;  $ b: chr "a string"</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ d:List of 2</span>
<span class="co">#&gt;   ..$ : num -1</span>
<span class="co">#&gt;   ..$ : num -5</span></code></pre></div>
<p>Come con i vettori, potete sottoporre a subset un vettore logico, intero o di caratteri.</p>
</li>
<li>
<p><code>[[</code> estrae un singolo componente da una lista. Rimuove un livello di gerarchia dalla lista.</p>
<div class="sourceCode" id="cb525"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">a</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;  int [1:3] 1 2 3</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">a</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ : num -1</span>
<span class="co">#&gt;  $ : num -5</span></code></pre></div>
</li>
<li>
<p><code>$</code> è un’abbreviazione per estrarre elementi nominati di una lista. Funziona in modo simile a <code>[[</code> eccetto che non c’è bisogno di usare le virgolette.</p>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span><span class="op">$</span><span class="va">a</span>
<span class="co">#&gt; [1] 1 2 3</span>
<span class="va">a</span><span class="op">[[</span><span class="st">"a"</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; [1] 1 2 3</span></code></pre></div>
</li>
</ul>
<p>La distinzione tra <code>[</code> e <code>[[</code> è davvero importante per le liste, perché <code>[[</code> si addentra nella lista mentre <code>[</code> restituisce una nuova lista più piccola. Confrontate il codice e l’output di cui sopra con la rappresentazione visiva nella figura <a href="vettori.html#fig:lists-subsetting">20.2</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lists-subsetting"></span>
<img src="diagrams/lists-subsetting.png" alt="Subsetting a list, visually." width="75%"><p class="caption">
Figure 20.2: Subsetting a list, visually.
</p>
</div>
</div>
<div id="liste-di-condimenti" class="section level3">
<h3>
<span class="header-section-number">20.5.3</span> Liste di condimenti<a class="anchor" aria-label="anchor" href="#liste-di-condimenti"><i class="fas fa-link"></i></a>
</h3>
<p>La differenza tra <code>[</code> e <code>[[</code> è molto importante, ma è facile confondersi. Per aiutarti a ricordare, lascia che ti mostri un insolito saliera per il pepe.</p>
<div class="inline-figure"><img src="images/pepper.jpg" width="25%" style="display: block; margin: auto;"></div>
<p>Se questa saliera di pepe è la vostra lista <code>x</code>, allora, <code>x[1]</code> è una saliera di pepe contenente un singolo pacchetto di pepe:</p>
<div class="inline-figure"><img src="images/pepper-1.jpg" width="25%" style="display: block; margin: auto;"></div>
<p><code>x[2]</code> avrebbe lo stesso aspetto, ma conterrebbe il secondo pacchetto. <code>x[1:2]</code> sarebbe una saliera per il pepe contenente due pacchetti di pepe.</p>
<p><code>x[[1]]</code> è:</p>
<div class="inline-figure"><img src="images/pepper-2.jpg" width="25%" style="display: block; margin: auto;"></div>
<p>Se voleste ottenere il contenuto del pacchetto pepper, avreste bisogno di <code>x[[1]][[1]]</code>:</p>
<div class="inline-figure"><img src="images/pepper-3.jpg" width="25%" style="display: block; margin: auto;"></div>
</div>
<div id="esercizi-56" class="section level3">
<h3>
<span class="header-section-number">20.5.4</span> Esercizi<a class="anchor" aria-label="anchor" href="#esercizi-56"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<p>Disegna le seguenti liste come insiemi annidati:</p>
<ol style="list-style-type: decimal">
<li><code>lista(a, b, lista(c, d), lista(e, f))</code></li>
<li>
<code>lista(lista(lista(lista(lista(lista(a))))))</code>)</li>
</ol>
</li>
<li><p>Cosa succede se si sottoinveste un tibble come se si stesse sottoponendo una lista?
Quali sono le differenze chiave tra una lista e una tibla?</p></li>
</ol>
</div>
</div>
<div id="attributi" class="section level2">
<h2>
<span class="header-section-number">20.6</span> Attributi<a class="anchor" aria-label="anchor" href="#attributi"><i class="fas fa-link"></i></a>
</h2>
<p>Ogni vettore può contenere metadati aggiuntivi arbitrari attraverso i suoi <strong>attributes</strong>. Puoi pensare agli attributi come a una lista di vettori denominata che può essere allegata a qualsiasi oggetto.
Potete ottenere e impostare i valori dei singoli attributi con <code><a href="https://rdrr.io/r/base/attr.html">attr()</a></code> o vederli tutti insieme con <code><a href="https://rdrr.io/r/base/attributes.html">attributes()</a></code>.</p>
<div class="sourceCode" id="cb527"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"greeting"</span><span class="op">)</span>
<span class="co">#&gt; NULL</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"greeting"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Hi!"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"farewell"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Bye!"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; $greeting</span>
<span class="co">#&gt; [1] "Hi!"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $farewell</span>
<span class="co">#&gt; [1] "Bye!"</span></code></pre></div>
<p>Ci sono tre attributi molto importanti che vengono utilizzati per implementare parti fondamentali di R:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Names</strong> sono usati per nominare gli elementi di un vettore. 1. 2. <strong>Dimensions</strong> (dims, in breve) fanno sì che un vettore si comporti come una matrice o un array. 1. <strong>Class</strong> è usato per implementare il sistema orientato agli oggetti S3.</li>
</ol>
<p>Avete visto i nomi sopra, e non parleremo di dimensioni perché non usiamo matrici in questo libro. Resta da descrivere la classe, che controlla il funzionamento delle <strong>funzioni generiche</strong>. Le funzioni generiche sono la chiave per la programmazione orientata agli oggetti in R, perché fanno sì che le funzioni si comportino diversamente per diverse classi di input. Una discussione dettagliata della programmazione orientata agli oggetti va oltre lo scopo di questo libro, ma potete leggerne di più in <em>Advanced R</em> a <a href="http://adv-r.had.co.nz/OO-essentials.html#s3" class="uri">http://adv-r.had.co.nz/OO-essentials.html#s3</a>.</p>
<p>Ecco come appare una tipica funzione generica:</p>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">as.Date</span>
<span class="co">#&gt; function (x, ...) </span>
<span class="co">#&gt; UseMethod("as.Date")</span>
<span class="co">#&gt; &lt;bytecode: 0x55ba511e1548&gt;</span>
<span class="co">#&gt; &lt;environment: namespace:base&gt;</span></code></pre></div>
<p>La chiamata a “UseMethod” significa che questa è una funzione generica, e chiamerà uno specifico <strong>method</strong>, una funzione, basata sulla classe del primo argomento. (Tutti i metodi sono funzioni; non tutte le funzioni sono metodi). Potete elencare tutti i metodi di un generico con <code>metodi()</code>:</p>
<div class="sourceCode" id="cb529"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/methods.html">methods</a></span><span class="op">(</span><span class="st">"as.Date"</span><span class="op">)</span>
<span class="co">#&gt; [1] as.Date.character   as.Date.default     as.Date.factor     </span>
<span class="co">#&gt; [4] as.Date.numeric     as.Date.POSIXct     as.Date.POSIXlt    </span>
<span class="co">#&gt; [7] as.Date.vctrs_sclr* as.Date.vctrs_vctr*</span>
<span class="co">#&gt; see '?methods' for accessing help and source code</span></code></pre></div>
<p>Per esempio, se <code>x</code> è un vettore di caratteri, <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> chiamerà <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date.character()</a></code>; se è un fattore, chiamerà <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date.factor()</a></code>.</p>
<p>Potete vedere l’implementazione specifica di un metodo con <code><a href="https://rdrr.io/r/utils/getS3method.html">getS3method()</a></code>:</p>
<div class="sourceCode" id="cb530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/getS3method.html">getS3method</a></span><span class="op">(</span><span class="st">"as.Date"</span>, <span class="st">"default"</span><span class="op">)</span>
<span class="co">#&gt; function (x, ...) </span>
<span class="co">#&gt; {</span>
<span class="co">#&gt;     if (inherits(x, "Date")) </span>
<span class="co">#&gt;         x</span>
<span class="co">#&gt;     else if (is.null(x)) </span>
<span class="co">#&gt;         .Date(numeric())</span>
<span class="co">#&gt;     else if (is.logical(x) &amp;&amp; all(is.na(x))) </span>
<span class="co">#&gt;         .Date(as.numeric(x))</span>
<span class="co">#&gt;     else stop(gettextf("do not know how to convert '%s' to class %s", </span>
<span class="co">#&gt;         deparse1(substitute(x)), dQuote("Date")), domain = NA)</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;bytecode: 0x55ba4ee8f2f0&gt;</span>
<span class="co">#&gt; &lt;environment: namespace:base&gt;</span>
<span class="fu"><a href="https://rdrr.io/r/utils/getS3method.html">getS3method</a></span><span class="op">(</span><span class="st">"as.Date"</span>, <span class="st">"numeric"</span><span class="op">)</span>
<span class="co">#&gt; function (x, origin, ...) </span>
<span class="co">#&gt; {</span>
<span class="co">#&gt;     if (missing(origin)) {</span>
<span class="co">#&gt;         if (!length(x)) </span>
<span class="co">#&gt;             return(.Date(numeric()))</span>
<span class="co">#&gt;         if (!any(is.finite(x))) </span>
<span class="co">#&gt;             return(.Date(x))</span>
<span class="co">#&gt;         stop("'origin' must be supplied")</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     as.Date(origin, ...) + x</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;bytecode: 0x55ba4ee956c0&gt;</span>
<span class="co">#&gt; &lt;environment: namespace:base&gt;</span></code></pre></div>
<p>Il più importante generico S3 è <code><a href="https://rdrr.io/r/base/print.html">print()</a></code>: controlla come l’oggetto viene stampato quando si digita il suo nome sulla console. Altri generici importanti sono le funzioni di subsetting <code>[</code>, <code>[[</code>, e <code>$</code>.</p>
</div>
<div id="vettori-incrementati" class="section level2">
<h2>
<span class="header-section-number">20.7</span> Vettori incrementati<a class="anchor" aria-label="anchor" href="#vettori-incrementati"><i class="fas fa-link"></i></a>
</h2>
<p>I vettori atomici e le liste sono i mattoni per altri importanti tipi di vettori come i fattori e le date. Li chiamo <strong>vettori aumentati</strong>, perché sono vettori con ulteriori <strong>attributi</strong>, inclusa la classe. Poiché i vettori aumentati hanno una classe, si comportano diversamente dal vettore atomico su cui sono costruiti. In questo libro, facciamo uso di quattro importanti vettori aumentati:</p>
<ul>
<li>Fattori</li>
<li>Date</li>
<li>Data-ora</li>
<li>Tibble</li>
</ul>
<p>Questi sono descritti di seguito.</p>
<div id="fattori-1" class="section level3">
<h3>
<span class="header-section-number">20.7.1</span> Fattori<a class="anchor" aria-label="anchor" href="#fattori-1"><i class="fas fa-link"></i></a>
</h3>
<p>I fattori sono progettati per rappresentare dati categorici che possono assumere un insieme fisso di possibili valori. I fattori sono costruiti sopra gli interi e hanno un attributo levels:</p>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ab"</span>, <span class="st">"cd"</span>, <span class="st">"ab"</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ab"</span>, <span class="st">"cd"</span>, <span class="st">"ef"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] "integer"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; $levels</span>
<span class="co">#&gt; [1] "ab" "cd" "ef"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "factor"</span></code></pre></div>
</div>
<div id="date-e-data-ora" class="section level3">
<h3>
<span class="header-section-number">20.7.2</span> Date e data-ora<a class="anchor" aria-label="anchor" href="#date-e-data-ora"><i class="fas fa-link"></i></a>
</h3>
<p>Le date in R sono vettori numerici che rappresentano il numero di giorni dal 1° gennaio 1970.</p>
<div class="sourceCode" id="cb532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"1971-01-01"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] 365</span>

<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] "double"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "Date"</span></code></pre></div>
<p>I data-ora sono vettori numerici con classe <code>POSIXct</code> che rappresentano il numero di secondi dal 1 gennaio 1970. (Nel caso ve lo steste chiedendo, “POSIXct” sta per “Portable Operating System Interface”, ora del calendario).</p>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hm</a></span><span class="op">(</span><span class="st">"1970-01-01 01:00"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] 3600</span>
<span class="co">#&gt; attr(,"tzone")</span>
<span class="co">#&gt; [1] "UTC"</span>

<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; [1] "double"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "POSIXct" "POSIXt" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tzone</span>
<span class="co">#&gt; [1] "UTC"</span></code></pre></div>
<p>L’attributo <code>tzone</code> è opzionale. Controlla come viene stampata l’ora, non a quale ora assoluta si riferisce.</p>
<div class="sourceCode" id="cb534"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tzone"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"US/Pacific"</span>
<span class="va">x</span>
<span class="co">#&gt; [1] "1969-12-31 17:00:00 PST"</span>

<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"tzone"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"US/Eastern"</span>
<span class="va">x</span>
<span class="co">#&gt; [1] "1969-12-31 20:00:00 EST"</span></code></pre></div>
<p>C’è un altro tipo di date-times chiamato POSIXlt. Questi sono costruiti sopra le liste con nome:</p>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXlt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; $names</span>
<span class="co">#&gt;  [1] "sec"    "min"    "hour"   "mday"   "mon"    "year"   "wday"   "yday"  </span>
<span class="co">#&gt;  [9] "isdst"  "zone"   "gmtoff"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "POSIXlt" "POSIXt" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tzone</span>
<span class="co">#&gt; [1] "US/Eastern" "EST"        "EDT"</span></code></pre></div>
<p>I POSIXlts sono rari all’interno del tidyverse. Spuntano fuori in R di base, perché sono necessari per estrarre componenti specifici di una data, come l’anno o il mese. Dato che lubridate fornisce degli helper per fare questo, non ne avete bisogno. I POSIXct sono sempre più facili da lavorare, quindi se scoprite di avere un POSIXlt, dovreste sempre convertirlo in un normale data time <code>lubridate::as_date_time()</code>.</p>
</div>
<div id="tibble-1" class="section level3">
<h3>
<span class="header-section-number">20.7.3</span> Tibble<a class="anchor" aria-label="anchor" href="#tibble-1"><i class="fas fa-link"></i></a>
</h3>
<p>Le tibble sono liste aumentate: hanno classe “tbl_df” + “tbl” + “data.frame”, e gli attributi <code>names</code> (colonna) e <code>row.names</code>:</p>
<div class="sourceCode" id="cb536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">tb</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">tb</span><span class="op">)</span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "tbl_df"     "tbl"        "data.frame"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $row.names</span>
<span class="co">#&gt; [1] 1 2 3 4 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $names</span>
<span class="co">#&gt; [1] "x" "y"</span></code></pre></div>
<p>La differenza tra una tibble e una lista è che tutti gli elementi di un data frame devono essere vettori della stessa lunghezza. Tutte le funzioni che lavorano con le tibble impongono questo vincolo.</p>
<p>I data.frame tradizionali hanno una struttura molto simile:</p>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, y <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; [1] "list"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt; $names</span>
<span class="co">#&gt; [1] "x" "y"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "data.frame"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $row.names</span>
<span class="co">#&gt; [1] 1 2 3 4 5</span></code></pre></div>
<p>La differenza principale è la classe. La classe di tibble include “data.frame”, il che significa che le tibble ereditano il comportamento dei normali data frame per default.</p>
</div>
<div id="esercizi-57" class="section level3">
<h3>
<span class="header-section-number">20.7.4</span> Esercizi<a class="anchor" aria-label="anchor" href="#esercizi-57"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Cosa restituisce <code>hms::hms(3600)</code>? Come si stampa? Quale primitiva
è costruito sopra il vettore aumentato? Quali attributi usa
usa?</p></li>
<li><p>Prova a fare un tibbo che abbia colonne di lunghezza diversa. Cosa
succede?</p></li>
<li><p>In base alla definizione di cui sopra, va bene avere una lista come
colonna di una tibla?</p></li>
</ol>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="funzioni.html"><span class="header-section-number">19</span> Funzioni</a></div>
<div class="next"><a href="iterazioni.html"><span class="header-section-number">21</span> Iterazioni</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#vettori"><span class="header-section-number">20</span> Vettori</a></li>
<li>
<a class="nav-link" href="#introduzione-13"><span class="header-section-number">20.1</span> Introduzione</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#prerequisiti-13"><span class="header-section-number">20.1.1</span> Prerequisiti</a></li></ul>
</li>
<li><a class="nav-link" href="#nozioni-di-base-sui-vettori"><span class="header-section-number">20.2</span> Nozioni di base sui vettori</a></li>
<li>
<a class="nav-link" href="#tipi-importanti-di-vettori-atomici"><span class="header-section-number">20.3</span> Tipi importanti di vettori atomici</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#logico"><span class="header-section-number">20.3.1</span> Logico</a></li>
<li><a class="nav-link" href="#numerico"><span class="header-section-number">20.3.2</span> Numerico</a></li>
<li><a class="nav-link" href="#carattere"><span class="header-section-number">20.3.3</span> Carattere</a></li>
<li><a class="nav-link" href="#valori-mancanti-4"><span class="header-section-number">20.3.4</span> Valori mancanti</a></li>
<li><a class="nav-link" href="#esercizi-54"><span class="header-section-number">20.3.5</span> Esercizi</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#usare-i-vettori-atomici"><span class="header-section-number">20.4</span> Usare i vettori atomici</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#coercizione"><span class="header-section-number">20.4.1</span> Coercizione</a></li>
<li><a class="nav-link" href="#funzioni-di-test"><span class="header-section-number">20.4.2</span> Funzioni di test</a></li>
<li><a class="nav-link" href="#scalari-e-regole-di-riciclaggio"><span class="header-section-number">20.4.3</span> Scalari e regole di riciclaggio</a></li>
<li><a class="nav-link" href="#denominazione-dei-vettori"><span class="header-section-number">20.4.4</span> Denominazione dei vettori</a></li>
<li><a class="nav-link" href="#vector-subsetting"><span class="header-section-number">20.4.5</span> Sottoinsiemi</a></li>
<li><a class="nav-link" href="#esercizi-55"><span class="header-section-number">20.4.6</span> Esercizi</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#liste"><span class="header-section-number">20.5</span> Vettori ricorsivi (liste)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#visualizzazione-delle-liste"><span class="header-section-number">20.5.1</span> Visualizzazione delle liste</a></li>
<li><a class="nav-link" href="#sottoinsieme"><span class="header-section-number">20.5.2</span> Sottoinsieme</a></li>
<li><a class="nav-link" href="#liste-di-condimenti"><span class="header-section-number">20.5.3</span> Liste di condimenti</a></li>
<li><a class="nav-link" href="#esercizi-56"><span class="header-section-number">20.5.4</span> Esercizi</a></li>
</ul>
</li>
<li><a class="nav-link" href="#attributi"><span class="header-section-number">20.6</span> Attributi</a></li>
<li>
<a class="nav-link" href="#vettori-incrementati"><span class="header-section-number">20.7</span> Vettori incrementati</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#fattori-1"><span class="header-section-number">20.7.1</span> Fattori</a></li>
<li><a class="nav-link" href="#date-e-data-ora"><span class="header-section-number">20.7.2</span> Date e data-ora</a></li>
<li><a class="nav-link" href="#tibble-1"><span class="header-section-number">20.7.3</span> Tibble</a></li>
<li><a class="nav-link" href="#esercizi-57"><span class="header-section-number">20.7.4</span> Esercizi</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/lucavd/r4ds_ita_1st_ed/blob/master/vectors.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/lucavd/r4ds_ita_1st_ed/edit/master/vectors.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R for Data Science - edizione italiana</strong>" was written by Hadley Wickham e Garrett Grolemund. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
